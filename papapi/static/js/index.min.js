let db,dbVersion=1;function close(){$("body").css("opacity","0"),setTimeout(function(){window.location.href="/second_step"},500)}function initDb(){let e=indexedDB.open("diplomas",dbVersion);e.onerror=function(e){console.error("Unable to open database.")},e.onsuccess=function(e){db=e.target.result,console.log("db opened")},e.onupgradeneeded=function(e){(db=e.target.result).createObjectStore("image",{keyPath:"timestamp"})}}function saveImage(e){let t=e.target.files[0];var n=new FileReader;n.readAsBinaryString(t),n.onload=function(e){let t=e.target.result,n={timestamp:Date.now(),data:t},o=db.transaction(["image"],"readwrite");o.objectStore("image").add(n).onerror=function(e){console.log("error storing data"),console.error(e)},o.oncomplete=function(e){sessionStorage.setItem("step",2),close()}}}document.addEventListener("DOMContentLoaded",()=>{initDb(),document.querySelector("#picture").addEventListener("change",saveImage),$("body").css("opacity","1")});